<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

    
    
    
    <link href="//fonts.googleapis.com/css?family=Quattrocento:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Quattrocento+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
    
    

    
    <title>Vinod Kurup</title>

    
    
    <link rel="stylesheet" href="/css/hugo-octopress.css">

    
    
    <link rel="stylesheet" href="/css/vinod.css">
    

    
    <link rel="stylesheet" href="/css/fork-awesome.min.css">
    

    
    <link href="/favicon.ico" rel="icon">

    
    <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Vinod Kurup" />

    <meta name="description" content="Inside Vinod Kurup&#39;s brain" />
    <meta name="keywords" content="">
    <meta name="author" content="Vinod Kurup, MD">

    
    <meta name="generator" content="Hugo 0.84.4" />

    
    

    
    
  </head>
  <body>

    
    <header role="banner">
<hgroup>
  
  <h1><a href="https://vkurup.github.io/">Vinod Kurup</a></h1>
    <h2>Hospitalist/programmer in search of the meaning of life</h2>
</hgroup></header>

    
    <nav role="navigation">
<fieldset class="mobile-nav">
  
  <select onchange="location = this.value;">
    <option value="">Navigate…</option>
    
    <option value="https://vkurup.github.io/">» Blog</option>
    
    <option value="https://vkurup.github.io/about/">» About Me</option>
    
    <option value="https://vkurup.github.io/post/">» Archives</option>
    
    <option value="https://vkurup.github.io/categories/">» Categories</option>
    
    <option value="https://vkurup.github.io/medicine/">» Medicine</option>
    
    <option value="https://vkurup.github.io/running/">» Running</option>
    
  </select>
</fieldset>


<ul class="main-navigation">
  
  
  
  <li><a href="https://vkurup.github.io/" title="Blog">Blog</a></li>
  
  
  
  <li><a href="https://vkurup.github.io/about/" title="About Me" >About Me</a></li>
  
  
  
  <li><a href="https://vkurup.github.io/post/" title="Archives" >Archives</a></li>
  
  
  
  <li><a href="https://vkurup.github.io/categories/" title="Categories" >Categories</a></li>
  
  
  
  <li><a href="https://vkurup.github.io/medicine/" title="Medicine" >Medicine</a></li>
  
  
  
  <li><a href="https://vkurup.github.io/running/" title="Running" >Running</a></li>
  
  
</ul>

<ul class="subscription">
  
  
  <a href="https://vkurup.github.io/index.xml" target="_blank" type="application/rss+xml" title="RSS"><i class="fa fa-rss fa-lg"></i></a>
  
  
</ul>


<form action="https://www.google.com/search" method="get" target="_blank">
  <fieldset role="search">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
    <input type="hidden" name="q" value="site:https://vkurup.github.io/" />
  </fieldset>
</form>

</nav>




  

<div id="main">
  <div id="content">
    <div class="blog-index">
      
      
      <article>
        
        

<header>
  <p class="meta">Feb 8, 2004
     - 1 minute read 
     - <a href="https://vkurup.github.io/blog/2004/02/08/christmas-break/#disqus_thread">Comments</a>

    
    
      - <a class="label" href="https://vkurup.github.io/categories/weird/">weird </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://vkurup.github.io/blog/2004/02/08/christmas-break/">Christmas Break</a>
  </h1>
</header>

        
          <p>I uploaded the <a href="http://kurup.org/photo/album?album_id=13244">pics from my trip home over Christmas</a>. Nope, this is not our house.  <!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->

        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Jan 15, 2004
     - 2 minute read 
     - <a href="https://vkurup.github.io/blog/2004/01/15/compiling-openfts-on-mac-os-x/#disqus_thread">Comments</a>

    
    
      - <a class="label" href="https://vkurup.github.io/categories/mac-os-x/">mac-os-x </a><a class="label" href="https://vkurup.github.io/categories/openacs/">openacs </a><a class="label" href="https://vkurup.github.io/categories/software/">software </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://vkurup.github.io/blog/2004/01/15/compiling-openfts-on-mac-os-x/">Compiling OpenFTS on Mac OS X</a>
  </h1>
</header>

        
          <p>It wasn&rsquo;t easy, but I finally got OpenFTS-0.3.2-tcl to compile on Mac OS X (10.2.8). I started by reading the excellent Mac OS X porting guides from <a href="http://fink.sourceforge.net/doc/porting/basics.php">Fink</a> and <a href="http://developer.apple.com/documentation/Porting/Conceptual/PortingUnix/intro/chapter_1_section_1.html">Apple</a>. Unfortunately, the OpenFTS Makefile and configure scripts aren&rsquo;t standard, so I had to muck around with things alot. Here&rsquo;s the diff:</p>
<pre><code>diff -U 2 -rbB Search-OpenFTS-tcl-0.3.2/aolserver/Makefile  Search-OpenFTS-tcl-0.3.2-vk/aolserver/Makefile 
--- Search-OpenFTS-tcl-0.3.2/aolserver/Makefile	Tue Nov 19 14:24:44 2002 
+++ Search-OpenFTS-tcl-0.3.2-vk/aolserver/Makefile	Wed Jan 14 23:23:13 2004 
@@ -13,6 +13,6 @@  
OBJ       = $(SOBJ) $(POBJ) $(OOBJ) nsfts.o  NSFTSLIB  = nsfts.so -LDSO      
= gcc -shared  INC       = -I../include -I$(NS_HOME)/include -I$(NS_HOME)/nsd +MODLIBS += -L/sw/lib -L/usr/local/aolserver/lib -ltcl8.4 -lnsd    .SUFFIXES: .c .h .so .l @@ -26,5 +26,5 @@    $(NSFTSLIB): $(OBJ) -	$(LDSO) $(OBJ) $(LIBS) -o $(NSFTSLIB) +	$(LDSO) $(OBJ) $(LIBS) -o $(NSFTSLIB) $(MODLIBS)    clean: diff -U 2 -rbB Search-OpenFTS-tcl-0.3.2/configure Search-OpenFTS-tcl-0.3.2-vk/configure --- Search-OpenFTS-tcl-0.3.2/configure	Tue Nov 19 14:24:44 2002 +++ Search-OpenFTS-tcl-0.3.2-vk/configure	Wed Jan 14 22:36:44 2004 @@ -2771,4 +2771,16 @@  fi   +# +# Mac OS X 10.2 +# +# vinodk: not sure if all of this is needed/accurate +if test `uname` = &quot;Darwin&quot;; then +    PLATFORM=&quot;osx&quot; +    CC=&quot;cc&quot; +    LD=&quot;cc&quot; +    CFLAGS=&quot;$CFLAGS -no-cpp-precomp&quot; +    LDSO=&quot;$LD -flat_namespace -bundle&quot; +fi +  if test $PLATFORM = &quot;unknown&quot;; then          { { echo &quot;$as_me:2774: error: unknown platform&quot; &gt;&amp;amp;5 
</code></pre>
<p>Then, follow the instructions in AOLSERVER.INSTALL. I&rsquo;m not too handy with this Makefile/configure stuff, so I&rsquo;d appreciate any guidance on how to do this properly :-).</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->

        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Jan 10, 2004
     - 5 minute read 
     - <a href="https://vkurup.github.io/blog/2004/01/10/installing-openacs-via-darwinports/#disqus_thread">Comments</a>

    
    
      - <a class="label" href="https://vkurup.github.io/categories/openacs/">openacs </a><a class="label" href="https://vkurup.github.io/categories/mac-os-x/">mac-os-x </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://vkurup.github.io/blog/2004/01/10/installing-openacs-via-darwinports/">Installing OpenACS via Darwinports</a>
  </h1>
</header>

        
          <h2 id="installing-openacs-via-darwinports">Installing OpenACS via Darwinports</h2>
<p><a href="/">by Vinod Kurup</a></p>
<hr>
<p>I&rsquo;ve created a Darwinports installation for OpenACS. (<a href="http://en.wikipedia.org/wiki/DarwinPorts" title="Darwinports on Wikipedia">What is Darwinports?</a>). This will allow you to set up a quick test installation
to try out OpenACS. I wouldn&rsquo;t recommend it for a production (or even a
development) server. For those purposes, I&rsquo;d strictly follow <a href="http://openacs.org/doc/openacs-5-1/complete-install.html" title="OpenACS Documentation">the OpenACS documentation</a>.</p>
<p>Download my <a href="/files/openacs-dports.tgz" title="OpenACS dport">OpenACS portfiles</a> and stick them in your local darwinports
repository. If you don&rsquo;t already have a local darwinports repository,
create one and add its location to <code>/opt/local/etc/ports/sources.conf</code> (I
use <code>file:///Users/vinod/dports-dev</code>). Here&rsquo;s the steps I took to get
everything to work (on Mac OS X Panther).</p>
<pre><code>:~$ wget http://www.kurup.org/files/openacs-dports.tgz
:~$ tar xvzf openacs-dports.tgz
dports-dev/www/
dports-dev/www/aolserver-nscache/
dports-dev/www/aolserver-nscache/Portfile
dports-dev/www/aolserver-nspostgres/
dports-dev/www/aolserver-nspostgres/files/
dports-dev/www/aolserver-nspostgres/files/patch-Makefile.diff
dports-dev/www/aolserver-nspostgres/Portfile
dports-dev/www/aolserver-nssha1/
dports-dev/www/aolserver-nssha1/Portfile
dports-dev/www/openacs/
dports-dev/www/openacs/files/
dports-dev/www/openacs/files/patch-config.diff
dports-dev/www/openacs/files/patch-functions.diff
dports-dev/www/openacs/files/patch-install-sh.diff
dports-dev/www/openacs/files/patch-install-tcl.diff
dports-dev/www/openacs/files/patch-nsd-postgres.diff
dports-dev/www/openacs/Portfile
dports-dev/www/tclwebtest/
dports-dev/www/tclwebtest/Portfile
dports-dev/textproc/
dports-dev/textproc/tdom/
dports-dev/textproc/tdom/Portfile
--&gt;:~$ cd dports-dev/
:~/dports-dev$ portindex
Creating software index in /Users/vinod/dports-dev
Adding port textproc/tdom
Adding port www/aolserver-nscache
Adding port www/aolserver-nspostgres
Adding port www/aolserver-nssha1
Adding port www/openacs
Adding port www/tclwebtest

Total number of ports parsed:	6 
Ports successfully parsed:	6	 
Ports failed:			0

:~/dports-dev$ cd
:~$ sudo port install postgresql +server
---&gt;  Fetching postgresql
---&gt;  Attempting to fetch postgresql-7.4.8.tar.bz2 from ftp://ftp2.ch.postgresql.org/mirror/postgresql/source/v7.4.8
---&gt;  Verifying checksum(s) for postgresql
---&gt;  Extracting postgresql
---&gt;  Applying patches to postgresql
---&gt;  Configuring postgresql
---&gt;  Building postgresql with target all
---&gt;  Staging postgresql into destroot
---&gt;  Packaging tgz archive for postgresql 7.4.8_0+darwin_7+server
---&gt;  Installing postgresql 7.4.8_0+darwin_7+server

:~$ sudo su postgres -c '/opt/local/bin/initdb -D /opt/local/var/db/pgsql/defaultdb'

The files belonging to this database system will be owned by user &quot;postgres&quot;.
This user must also own the server process.

The database cluster will be initialized with locale C.

creating directory /opt/local/var/db/pgsql/defaultdb... ok
creating directory /opt/local/var/db/pgsql/defaultdb/base... ok
creating directory /opt/local/var/db/pgsql/defaultdb/global... ok
creating directory /opt/local/var/db/pgsql/defaultdb/pg_xlog... ok
creating directory /opt/local/var/db/pgsql/defaultdb/pg_clog... ok
selecting default max_connections... 50
selecting default shared_buffers... 300
creating configuration files... ok
creating template1 database in /opt/local/var/db/pgsql/defaultdb/base/1... ok
initializing pg_shadow... ok
enabling unlimited row size for system tables... ok
initializing pg_depend... ok
creating system views... ok
loading pg_description... ok
creating conversions... ok
setting privileges on built-in objects... ok
creating information schema... ok
vacuuming database template1... ok
copying template1 to template0... ok

Success. You can now start the database server using:

    /opt/local/bin/postmaster -D /opt/local/var/db/pgsql/defaultdb
            or
    /opt/local/bin/pg_ctl -D /opt/local/var/db/pgsql/defaultdb -l logfile start

    :~$ sudo su postgres -c '/opt/local/bin/pg_ctl -D /opt/local/var/db/pgsql/defaultdb -l /opt/local/var/log/pgsql/defaultdb.log start'
    postmaster successfully started

    :~$ sudo port install openacs
    
    ---&gt;  Fetching aolserver
    ---&gt;  Attempting to fetch aolserver-4.0.10-src.tar.gz from http://kent.dl.sourceforge.net/aolserver
    ---&gt;  Verifying checksum(s) for aolserver
    ---&gt;  Extracting aolserver
    ---&gt;  Configuring aolserver
    ---&gt;  Building aolserver with target all
    ---&gt;  Staging aolserver into destroot
    ---&gt;  Packaging tgz archive for aolserver 4.0.10_0
    ---&gt;  Installing aolserver 4.0.10_0
    
    AOLserver installed into /opt/local/aolserver
    
    You now need to configure the server to your needs. You 
    might want to create another user (e.g. aolserver) to run 
    the server.
    ---&gt;  Activating aolserver 4.0.10_0
    ---&gt;  Cleaning aolserver
    ---&gt;  Fetching aolserver-nscache
    ---&gt;  Attempting to fetch nscache-1.5.tar.gz from http://kent.dl.sourceforge.net/aolserver
    ---&gt;  Verifying checksum(s) for aolserver-nscache
    ---&gt;  Extracting aolserver-nscache
    ---&gt;  Configuring aolserver-nscache
    ---&gt;  Building aolserver-nscache with target all
    ---&gt;  Staging aolserver-nscache into destroot
    ---&gt;  Packaging tgz archive for aolserver-nscache 1.5_0
    ---&gt;  Installing aolserver-nscache 1.5_0
    ---&gt;  Activating aolserver-nscache 1.5_0
    ---&gt;  Cleaning aolserver-nscache
    ---&gt;  Fetching aolserver-nspostgres
    ---&gt;  Attempting to fetch nspostgres-4.0.tar.gz from http://kent.dl.sourceforge.net/aolserver
    ---&gt;  Verifying checksum(s) for aolserver-nspostgres
    ---&gt;  Extracting aolserver-nspostgres
    ---&gt;  Applying patches to aolserver-nspostgres
    ---&gt;  Configuring aolserver-nspostgres
    ---&gt;  Building aolserver-nspostgres with target all
    ---&gt;  Staging aolserver-nspostgres into destroot
    ---&gt;  Packaging tgz archive for aolserver-nspostgres 4.0_0
    ---&gt;  Installing aolserver-nspostgres 4.0_0
    ---&gt;  Activating aolserver-nspostgres 4.0_0
    ---&gt;  Cleaning aolserver-nspostgres
    ---&gt;  Fetching aolserver-nssha1
    ---&gt;  Attempting to fetch nssha1-0.1.tar.gz from http://kent.dl.sourceforge.net/aolserver
    ---&gt;  Verifying checksum(s) for aolserver-nssha1
    ---&gt;  Extracting aolserver-nssha1
    ---&gt;  Configuring aolserver-nssha1
    ---&gt;  Building aolserver-nssha1 with target all
    ---&gt;  Staging aolserver-nssha1 into destroot
    ---&gt;  Packaging tgz archive for aolserver-nssha1 0.1_0
    ---&gt;  Installing aolserver-nssha1 0.1_0
    ---&gt;  Activating aolserver-nssha1 0.1_0
    ---&gt;  Cleaning aolserver-nssha1
    ---&gt;  Fetching tclwebtest
    ---&gt;  Verifying checksum(s) for tclwebtest
    ---&gt;  Extracting tclwebtest
    ---&gt;  Configuring tclwebtest
    ---&gt;  Building tclwebtest with target all
    ---&gt;  Staging tclwebtest into destroot

    be sure that /opt/local/lib is included in your TCL path:
    tcsh: setenv TCLLIBPATH &quot;$TCLLIBPATH /opt/local/lib&quot;
    bash: export TCLLIBPATH &quot;$TCLLIBPATH /opt/local/lib&quot;
    ---&gt;  Packaging tgz archive for tclwebtest 0.9_0
    ---&gt;  Installing tclwebtest 0.9_0
    ---&gt;  Activating tclwebtest 0.9_0
    ---&gt;  Cleaning tclwebtest
    ---&gt;  Fetching tdom
    ---&gt;  Attempting to fetch tDOM-0.8.0.tar.gz from http://www.tdom.org/files/
    ---&gt;  Verifying checksum(s) for tdom
    ---&gt;  Extracting tdom
    ---&gt;  Configuring tdom
    ---&gt;  Building tdom with target all
    ---&gt;  Staging tdom into destroot
    
    be sure that /opt/local/lib is included in your TCL path:
    tcsh: setenv TCLLIBPATH &quot;$TCLLIBPATH /opt/local/lib&quot;
    bash: export TCLLIBPATH=&quot;$TCLLIBPATH /opt/local/lib&quot;
    ---&gt;  Packaging tgz archive for tdom 0.8.0_0
    ---&gt;  Installing tdom 0.8.0_0
    ---&gt;  Activating tdom 0.8.0_0
    ---&gt;  Cleaning tdom
    ---&gt;  Fetching openacs
    ---&gt;  Attempting to fetch openacs-5.1.5.tar.gz from http://openacs.org/projects/openacs/download/download/
    ---&gt;  Verifying checksum(s) for openacs
    ---&gt;  Extracting openacs
    ---&gt;  Applying patches to openacs
    ---&gt;  Configuring openacs
    ---&gt;  Building openacs with target all
    ---&gt;  Staging openacs into destroot
    ---&gt;  Packaging tgz archive for openacs 5.1.5_0
    ---&gt;  Installing openacs 5.1.5_0
    ---&gt;  Activating openacs 5.1.5_0
    Running the OpenACS install script. (could take 10-15 minutes)
    OpenACS should now be running with the following settings:
    url:          http://127.0.0.1
    serverroot:   /opt/local/openacs/service0
    logs:         /opt/local/openacs/service0/log
    PID files:    /opt/local/aolserver/log
    admin user:   admin@localhost
    admin passwd: 1
    UNIX uid:     service0
    UNIX gid:     web
    
    Adjust AOLserver settings in /opt/local/openacs/service0/etc/config.tcl
    Adjust OpenACS settings through the web interface.
    ---&gt;  Cleaning openacs
    :~$ 
</code></pre>
<p>Be patient once the install script starts running. It takes a <strong>long</strong>
time. Again, this is just a quick and dirty way of trying out OpenACS. I&rsquo;d
be happy to hear any comments or questions.</p>
<hr>

        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Jan 9, 2004
     - 1 minute read 
     - <a href="https://vkurup.github.io/blog/2004/01/09/now-running-openacs-5/#disqus_thread">Comments</a>

    
    
      - <a class="label" href="https://vkurup.github.io/categories/openacs/">openacs </a><a class="label" href="https://vkurup.github.io/categories/programming/">programming </a><a class="label" href="https://vkurup.github.io/categories/software/">software </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://vkurup.github.io/blog/2004/01/09/now-running-openacs-5/">Now running OpenACS 5</a>
  </h1>
</header>

        
          <p>I upgraded to OpenACS 5 thanks to <a href="http://openacs.org/projects/openacs/5.0/upgrade-463-50">instructions from DaveB, et. al.</a> I had a <a href="http://openacs.org/forums/message-view?message_id=145889">few hitches with that process</a>, but the system seems to be working OK and is certainly zippier. I haven&rsquo;t tested everything out yet, so please holler if anything breaks.</p>

        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Jan 5, 2004
     - 1 minute read 
     - <a href="https://vkurup.github.io/blog/2004/01/05/open-source-saved-my-photos/#disqus_thread">Comments</a>

    
    
      - <a class="label" href="https://vkurup.github.io/categories/mac-os-x/">mac-os-x </a><a class="label" href="https://vkurup.github.io/categories/free-software/">free-software </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://vkurup.github.io/blog/2004/01/05/open-source-saved-my-photos/">Open Source saved my photos!</a>
  </h1>
</header>

        
          <p>Loyal readers of my blog will remember that my Powerbook Wallstreet G3 died on September 21st, 2002. Since I&rsquo;m probably the only one that remembers, I&rsquo;ll point you to that <a href="http://kurup.org/blog/2002/09/22/rip">blog entry</a>. The good news was that the hard drive was intact, the bad news was that I didn&rsquo;t have an easy way of accessing it. I have a Firewire enclosure, and my old Powerbook was running Linux, so I figured it wouldn&rsquo;t be too difficult to get my new Powerbook to read the data off the old HD. I mean Mac OS X and Linux are the same underneath, right? Well, not quite. Mac OS X uses a filesystem called HFS+ and my version of Linux uses a filesystem called ext2. Turns out that no one had written an ext2 driver for Mac OS X.</p>
<p>So, I turned to Google and with more effort than usual, found the <a href="http://sourceforge.net/projects/ext2fsx/">Mac OS X Ext2 Filesystem</a> Project, or ext2fsx. I subscribed to the RSS feed and just waited until I saw the 1.0.1 product released on 11/20/2003 (Never trust the 1.0!). I loaded it up and voila! My old Wallstreet was back. Thank you <a href="http://www.classicalguitar.net/brian/">Brian Bergstrand</a>!</p>
<p>In celebration, I&rsquo;ve uploaded <a href="http://kurup.org/photo/index?folder_id=9672">pictures from 2001 and early 2002</a> that I thought I had lost forever. Enjoy.</p>

        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Jan 2, 2004
     - 8 minute read 
     - <a href="https://vkurup.github.io/blog/2004/01/02/backup-strategy/#disqus_thread">Comments</a>

    
    
      - <a class="label" href="https://vkurup.github.io/categories/rsync/">rsync </a><a class="label" href="https://vkurup.github.io/categories/sysadmin/">sysadmin </a><a class="label" href="https://vkurup.github.io/categories/backup/">backup </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://vkurup.github.io/blog/2004/01/02/backup-strategy/">Backup strategy</a>
  </h1>
</header>

        
          <p><a href="http://badgertronics.com">Badgertronics.com</a>, <a href="http://borkware.com">borkware.com</a>, and company went through the same ordeal that <a href="http://kurup.org/blog/2003/12/17/im-back">kurup.org</a> did and MarkD has promptly published his <a href="http://borkware.com/rants/rsync-backups/">new backup strategy</a>. He uses <a href="http://rsync.samba.org/">rsync</a> over <a href="http://www.openssh.com/">SSH</a> which, interestingly enough, is the same strategy that I came up with. Great minds must think alike.</p>
<p>The canonical standard for doing backups on UNIX systems is tar (short for <strong>t</strong>ape <strong>ar</strong>chive). tar converts directories of files into a single tar archive file which you would then spit to an attached tape drive. To be up-to-date, you need to do this on a regular basis - perhaps daily. So each day, you&rsquo;d tar up all your important files and send them off to the tape drive. To recover your files, you&rsquo;d need to read the whole tar archive file back from the tape and then extract the specific files or directories that you want from the tar archive. This works fine if you&rsquo;re backing up to a tape drive, because you don&rsquo;t care about network bandwidth. If you&rsquo;re backing up over the network to another machine&rsquo;s hard drive, then each daily archive file has to be sent over the network to your backup machine. Even if you don&rsquo;t change any files from one day to the next, the entire set of files gets archived and sent across the network. Bye bye precious bandwidth!</p>
<p>rsync is a <strong>r</strong>emote <strong>sync</strong>hronization tool. The first time, rsync sends all the data over the network to your backup machine. Just like tar. The benefit comes the next time you backup. Instead of sending all the files again, rsync only transfers files that have been changed. If no files were changed, no files get transferred. And when you want to recover data, you transfer just the specific files that you want back to your machine (using rsync or scp or telnet or whatever).</p>
<p>Note that rsync also works better than an incremental backup strategy using tar. You can use tar to do a full backup weekly and incremental backups daily. Incremental backups backup just files which have changed since yesterday&rsquo;s backup. This will improve bandwidth usage, but makes recovery more complex. You have to extract the latest full backup, then extract any more recent incremental backups over your full backup and then extract the specific files that you need. On the other hand, the backup produced with rsync is always up-to-date (as of the last time you ran rsync).</p>
<p>There are lots of backup tools that use rsync as their workhorse and add features on top of it. <a href="http://rdiff-backup.stanford.edu/">rdiff-backup</a> makes regularly scheduled backups, but each time it runs, it keeps a copy of the changes to any files which have changed (i.e. the diff&rsquo;s) as well as the date and time of those changes. So, while the backup filesystem is a perfect mirror of your system, a few extra commands can give you a copy of your filesystem as it was, say, 5 days ago. rdiff-backup takes the backup filesystem and applies any diffs that occurred over the past five days. Diff files only record changes from one version of a file to another, so they are very small (in proportion to the entire backup). This allows rdiff-backup to provide snapshots of your system at almost any time without using a significant amount of disk space.</p>
<p>I tried rdiff-backup and it works great for Linux to Linux backups, but it gave me trouble when I tried to backup Linux to Mac OS X. Linux uses a case-sensitive filesystem (ext2). You can have the files <code>foo</code> and <code>FOO</code> in the same directory and Linux treats them as different files. Mac OS X&rsquo;s file system is case-insensitive, so if you make a file <code>FOO</code>, it will overwrite a file <code>foo</code> in the same directory. rdiff-backup tries to take this into account by quoting any filename with capital letters in it. Unfortunately, the most recent version from CVS (as of 2004-01-01) <a href="http://lists.gnu.org/archive/html/rdiff-backup-users/2003-12/msg00045.html">doesn&rsquo;t properly unquote them</a>. Even if it did work properly, it ruins one of the main benefits of using rsync - having a true mirror of your system. Now instead of having a file <code>README</code> in your backup, you have a file <code>;082;069;065;068;077;069</code> (that&rsquo;s <code>README</code> quoted). I can no longer just scp a directory from my Mac backup machine to my linux server. I have to use rdiff-backup to do the transfer so that it gets properly unquoted. I would prefer to be able to turn the quoting stuff off completely. If you&rsquo;re crazy enough to have 2 files in a Linux directory with the same name, but just capitalized differently, you&rsquo;re just asking for trouble.</p>
<p>I also realized that rdiff-backup is overkill for what I need. If I really want to be able to recover a file that I deleted 5 days ago, I should be using CVS for that data. My backups are there simply for unexpected data loss.</p>
<p>So, I&rsquo;m currently using plain rsync over SSH. I do 2 things to prepare my system before running rsync. First, I run <code>dpkg --get-selections</code> to dump a list of my installed Debian packages. When recovering my system, I can feed that file to <code>dpkg --set-selections</code> and then run <code>apt-get dselect-upgrade</code> to get all my packages set up as I had before. So, I put this in my crontab:</p>
<pre><code> # save apt selections 00 20 * * *  /usr/bin/dpkg --get-selections &gt; /home/vinod/apt-settings/dpkg-selections
</code></pre>
<p>The other thing I need to do is to dump my Postgres databasse. I currently do this from a scheduled procedure in AOLserver as documented at the bottom of the <a href="http://openacs.org/doc/openacs-4-6-3/backup-recovery.html">OpenACS 4.6.3 documentation</a>.</p>
<p>Finally, we get to rsync. Like MarkD, I&rsquo;m going to run rsync from my Mac and pull the data from the Linux server over to the Mac. Unlike MarkD, I&rsquo;m going to run rsync as my root user so that I can preserve users and groups of my <code>/etc</code> files. Here&rsquo;s my root crontab entry on my Mac (split into multiple lines for reading convenience):</p>
<pre><code>00 21 * * * rsync -av --numeric-ids --delete --delete-excluded
   --exclude-from=/Users/vinod/backup/acorn_exclude -e ssh acorn:/
   /Users/vinod/backup/acorn/latest &gt;&gt; /Users/vinod/backup/backup.log
</code></pre>
<p>The <code>'v'</code> option is for verbose, which I&rsquo;ll turn off eventually once I know things are working well. The <code>--numeric-ids</code> option preserves the user and group ids as numeric ids rather than trying to use user/group names from my Mac. the <code>--delete</code> and <code>--delete-excluded</code> make sure that files deleted on the Linux server are also deleted in the backup. The <code>--exclude-from</code> reads <code>/Users/vinod/backup/acorn_exclude</code> and follows its instructions as to which files to backup. I&rsquo;ll talk about that next. The <code>-e</code> option says to use SSH to transfer the data. Finally the last two options say to get the data from host acorn (set to vkurup.acornhosting.net in <code>/etc/hosts</code>) and rsync it to <code>/Users/vinod/backup/acorn/latest</code>. To see exactly what files rsync is excluding or including, add another <code>-v</code> option to rsync. Also useful is the <code>-n</code> option, which tells rsync to show you what it would do without actually transferring anything.</p>
<p>Here&rsquo;s what my exclude file looks like:</p>
<pre><code>- *~
+ /etc 
- /home/vinod/web/kurup/log 
+ /home 
+ /root 
+ /usr 
+ /usr/local 
- /usr/* 
- /var/lib/courier 
- /var/lib/postgres/data 
+ /var 
+ /var/lib 
- /var/* 
- /*
</code></pre>
<p>The rsync exclude syntax allows you to backup just the files you want. I&rsquo;ll just discuss a couple examples, so you should see the manpage for more details. Line 1 says to ignore any emacs backup files. Line 3 says to ignore <code>/home/vinod/web/kurup/log</code> while Line 4 says to include everything else in the <code>/home</code> directory. Conversely, line 7 says to include <code>/usr/local</code> (and everything in it), while Line 8 says to ignore anything else in the <code>/usr</code> directory. Line 6 is important. If you didn&rsquo;t include it, nothing in <code>/usr/local</code> would get included. Each filename is checked against this list, but in a recursive fashion. So if rsync is working on the file <code>/usr/local/foo</code>, it first looks for a pattern that matches <code>/usr</code>, then for a pattern that matches <code>/usr/local</code>, then finally for a pattern that matches <code>/usr/local/foo</code>. It uses the first pattern that matches. So, if you didn&rsquo;t include line 6, the search for <code>/usr</code> would find line 8 and stop, thus excluding everything in <code>/usr/local</code>. Not what you want. I know that was confusing - recursion always makes my head spin&hellip;</p>
<p>OK, the final thing is to set up SSH properly. I basically set it up like MarkD did, but since I need to login as root, I wanted to add a few more constraints. You can set up SSH to restrict a specific key to only run a certain command. So if someone somehow gets access to my key, they&rsquo;ll only be able to run rsync. If you don&rsquo;t put the command restriction in, they&rsquo;ll be able to login to your server as root. To add restraints to a key, add some statements to the beginning of the key in authorized_keys2. Here&rsquo;s my <code>/root/.ssh/authorized_keys2</code> (split onto multiple lines):</p>
<pre><code>command=&quot;rsync --server --sender -vlogDtpr --delete-excluded --numeric-ids . /&quot;  
ssh-rsa AAAAB....&lt;snip&gt; ...t8= root@Vinod-Kurups-Computer.local. 
</code></pre>
<p>To get the proper command to put in your command=&quot;&quot; statement, run your rsync command with an unrestricted SSH key first (i.e. just copy the id_rsa.pub to authorized_keys2). When you run the rsync command on your Mac, do a <code>ps auxw | grep rsync</code> on the server machine. The command that you see listed is the command that goes in the key.</p>
<p>After reading MarkD&rsquo;s article, the one thing I might change is to tar up the data on the Linux server that needs its user/group info preserved (<code>/etc</code>, <code>/root</code>, and <code>/usr/local</code>) and then store that on the server in my user&rsquo;s home directory. I then wouldn&rsquo;t have to rsync as root, so it would simplify things. The drawback is that anytime anything changed in any of those directories, I&rsquo;d be backing up the entire directories again. Hopefully this would be mitigated by the fact that they wouldn&rsquo;t change often and since they&rsquo;re mostly text files, they compress well.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->

        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Dec 17, 2003
     - 1 minute read 
     - <a href="https://vkurup.github.io/blog/2003/12/17/im-back/#disqus_thread">Comments</a>

    
    
      - <a class="label" href="https://vkurup.github.io/categories/sysadmin/">sysadmin </a><a class="label" href="https://vkurup.github.io/categories/openacs/">openacs </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://vkurup.github.io/blog/2003/12/17/im-back/">I&#39;m back!</a>
  </h1>
</header>

        
          <p>This site was down for the past few days due to a <a href="http://openacs.org/forums/message-view?message_id=152527">SNAFU with acornhosting&rsquo;s upstream provider</a>. You&rsquo;d think I&rsquo;d have learned to have a backup strategy in place by now, but you&rsquo;d be overestimating my intelligence. Luckily, Cathy was somehow able to negotiate with her failed upstream provider to get my (and other acornhosting customers') data back. After this episode, I promise to backup religiously and I&rsquo;m even more sold on <a href="http://acornhosting.net">acornhosting</a> as a solid web hosting provider.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->

        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Dec 11, 2003
     - 1 minute read 
     - <a href="https://vkurup.github.io/blog/2003/12/11/errata-for-quick-calculus/#disqus_thread">Comments</a>

    
    
      - <a class="label" href="https://vkurup.github.io/categories/book-review/">book-review </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://vkurup.github.io/blog/2003/12/11/errata-for-quick-calculus/">Errata for Quick Calculus</a>
  </h1>
</header>

        
          <p>I just read <a href="http://www.amazon.com/exec/obidos/ASIN/0471827223/vinodkurupshomep">Quick Calculus: A Self-Teaching Guide, 2nd Edition</a> by Daniel Kleppner and Norman Ramsey. I found a few errors, but couldn&rsquo;t find an errata listing online, so I&rsquo;m documenting them here for future reference.</p>
<ol>
<li>
<p>Page 107, Frame 206. The quotient rule as it&rsquo;s initially expressed is incorrect. The correct version is stated at the bottom of the page and also on page 102, Frame 194.</p>
</li>
<li>
<p>Page 173, Frame 330. None of the options listed are correct. The correct answer is 15</p>
</li>
<li>
<p>Page 187, Frame 355. The initial expression of Simpson&rsquo;s rule is confusing. It should be: <!-- raw HTML omitted --> <!-- raw HTML omitted --> ∫<!-- raw HTML omitted -->A<!-- raw HTML omitted --><!-- raw HTML omitted -->B<!-- raw HTML omitted --> y dx = 2/6 Δ (y<!-- raw HTML omitted -->0<!-- raw HTML omitted --> + 4y<!-- raw HTML omitted -->1<!-- raw HTML omitted --> + y<!-- raw HTML omitted -->2<!-- raw HTML omitted --> + <!-- raw HTML omitted -->y<!-- raw HTML omitted -->2<!-- raw HTML omitted --> +<!-- raw HTML omitted --> 4y<!-- raw HTML omitted -->3<!-- raw HTML omitted --> + y<!-- raw HTML omitted -->4<!-- raw HTML omitted --> + &hellip; + y<!-- raw HTML omitted -->N-2<!-- raw HTML omitted --> + 4y<!-- raw HTML omitted -->N-1<!-- raw HTML omitted --> + y<!-- raw HTML omitted -->N<!-- raw HTML omitted -->) <!-- raw HTML omitted --> <!-- raw HTML omitted --></p>
</li>
</ol>
<p>Errors in technical books annoy me because I spend way too much time trying to figure out why I&rsquo;m mixed up. Not having a published errata online annoys me even more. See <a href="http://borkware.com/corebook/errata">Mark&rsquo;s book</a> for an errata page done right.</p>
<p>All ranting aside, Quick Calculus is an ideal resource if you&rsquo;re looking to brush up on the basics of Calculus. It&rsquo;s short and interactive, yet it doesn&rsquo;t sugarcoat the material.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->

        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Dec 9, 2003
     - 1 minute read 
     - <a href="https://vkurup.github.io/blog/2003/12/09/christmas-party/#disqus_thread">Comments</a>

    
    
      - <a class="label" href="https://vkurup.github.io/categories/family/">family </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://vkurup.github.io/blog/2003/12/09/christmas-party/">Christmas Party</a>
  </h1>
</header>

        
          <p>I missed the Milwaukee Malayalee Christmas Party this past weekend, but Lisa sent me <a href="http://kurup.org/photo/album?album_id=9589">pics</a>. Can&rsquo;t wait to go home for the holidays&hellip;</p>

        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Dec 9, 2003
     - 1 minute read 
     - <a href="https://vkurup.github.io/blog/2003/12/09/summer-reunion/#disqus_thread">Comments</a>

    
    
      - <a class="label" href="https://vkurup.github.io/categories/family/">family </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://vkurup.github.io/blog/2003/12/09/summer-reunion/">Summer Reunion</a>
  </h1>
</header>

        
          <p>Ooops - I just realized that I forgot to link to the <a href="http://kurup.org/photo/album?album_id=7436">pics from our Reunion</a> back in August. At least I got them posted before the end of the year.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->

        
      </article>
      
      
      






<div class="pagination">

  
  
  
  
  <a href="/" aria-label="First" class="label-pagination"><i class="fa fa-angle-double-left fa-lg"></i></a>
  

  
  
  <a href="/page/22/" aria-label="Previous" class="label-pagination"><i class="fa fa-angle-left fa-lg"></i></a>
  

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  

  
  
  <a href="/page/24/" aria-label="Next" class="label-pagination"><i class="fa fa-angle-right fa-lg"></i></a>
  

  
  
  <a href="/page/31/" aria-label="Last"><i class="fa fa-angle-double-right fa-lg"></i></a>
  

</div>

  
    </div>
    

<aside class="sidebar thirds">
  <section class="first odd">

    

    <p>
      
    </p>
  </section>

  

  
  <ul class="sidebar-nav">
    <li class="sidebar-nav-item">
      <a target="_blank" href="https://github.com/vkurup/" title="https://github.com/vkurup/"><i class="fa fa-github fa-3x"></i></a>
      
      
      <a target="_blank" href="https://twitter.com/vkurup/" title="https://twitter.com/vkurup/"><i class="fa fa-twitter fa-3x"></i></a>
      
      <a target="_blank" href="https://keybase.io/vkurup/" title="https://keybase.io/vkurup/"><i class="fa fa-keybase fa-3x"></i></a> 
      
      
      <a target="_blank" href="https://stackoverflow.com/users/347942" title="https://stackoverflow.com/users/347942"><i class="fa fa-stack-overflow fa-3x"></i></a>
      
      
      
      
      

      
      
    </li>
  </ul>

  

  

  
  
  
  
  <section class="even">
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      
      
      
      <li class="post">
        <a href="/blog/2021/05/09/first-post-of-2021/">First Post of 2021</a>
      </li>
      
      
      
      
      
      <li class="post">
        <a href="/blog/2020/12/12/advent-of-code-elixir-day-1/">Advent of Code Elixir Day 1</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2020/12/11/install-multiple-python-versions-using-pyenv/">Install multiple python versions using pyenv</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2020/12/10/disk-space-hogs/">Disk Space Hogs</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2020/12/09/deleting-old-snaps/">Deleting old snaps</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2020/08/21/using-an-obi110-for-voip-service/">Using an OBi110 for VOIP service</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2020/08/17/django-forms-have-2-modes/">Django forms have 2 modes</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2020/01/27/aws-xray-brain-dump/">AWS Xray brain dump</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2019/12/11/we-have-always-lived-in-the-castle/">We have always lived in the castle</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2019/11/27/open-borders/">Open Borders</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2019/11/18/deep-survival-d%C3%A9j%C3%A0-vu/">Deep Survival Déjà Vu</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2019/11/17/ports-and-networks/">Ports and networks</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2019/11/17/hugo/">Hugo</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2019/04/08/avik-730/">Avik 7:30</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2018/12/20/triangle-race-series/">Triangle Race Series</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2018/12/02/my-nest-journey/">My Nest Journey</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2018/09/23/composting/">Composting</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2018/09/22/starting-a-garden/">Starting a garden</a>
      </li>
      
      
      
      <li class="post">
        <a href="/blog/2018/05/31/history-of-indian-civilization/">History of Indian Civilization</a>
      </li>
      
      
    </ul>
  </section>
  
  

  <section class="odd">
    <h1>My Pinboard</h1>
    <ul id="pinboard_linkroll">Fetching linkroll...</ul>
    <p><a href="http://pinboard.in/u:vkurup">My Pinboard Bookmarks &raquo;</a></p>
  </section>
  <script type="text/javascript">
  var linkroll = 'pinboard_linkroll'; 
  var pinboard_user = "vkurup"; 
  var pinboard_count = 10; 
  (function(){
    var pinboardInit = document.createElement('script');
    pinboardInit.type = 'text/javascript';
    pinboardInit.async = true;
    pinboardInit.src = '/js/pinboard.js';
    document.getElementsByTagName('head')[0].appendChild(pinboardInit);
  })();
  </script>

</aside>
    
  </div>
</div>
    <footer role="contentinfo">
      <p>Copyright &copy; 2021 Vinod Kurup, MD - <a href="https://vkurup.github.io/license/">License</a> -
        <span class="credit">Powered by <a target="_blank" href="https://gohugo.io">Hugo</a> and <a target="_blank" href="https://github.com/parsiya/hugo-octopress/">Hugo-Octopress</a> theme.
      </p>
    </footer>

    
    
    

    
      <script>
        var _gaq=[['_setAccount','UA-79447-1'],['_trackPageview']];
        (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
        s.parentNode.insertBefore(g,s)}(document,'script'));
      </script>
    

    <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "2f7b54393e3c4799ab8f37fcaf97e029"}'></script>
  </body>
</html>
   

